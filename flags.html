<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>הצגת דגל אקראי עם טיימר</title>
    <style>
        #flagContainer {
            text-align: center;
            margin-top: 50px;
        }
        #flag {
            cursor: pointer;
            width: 600px;
            border: 1px solid black;
        }
        #countryName {
            cursor: pointer;
            font-size: 30px;
            display: none;
            margin-top: 10px;
        }
        #countryInfo, #flagInfo {
            font-size: 18px;
            margin-top: 10px;
            text-align: justify;
            direction: rtl;
            margin-left: auto;
            margin-right: auto;
            width: 600px;
            white-space: pre-line;
        }
        #timer {
            font-size: 30px;
            text-align: center;
            margin-top: 10px;
        }
        #toggleButton {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        #timerContainer {
            position: absolute;
            top: 50px;
            left: 10px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <button id="toggleButton">החלף למצב עם טיימר</button>
    <div id="timerContainer">
        <div id="timer"></div>
    </div>
    <div id="flagContainer">
        <img id="flag" src="" alt="דגל מדינה">
        <div id="countryName"></div>
        <div id="countryInfo"></div>
        <div id="flagInfo"></div>
    </div>

    <script>
        // רשימת המדינות צריכה להיות מוטענת כאן מקובץ אחר
        const countries = [
    { "country": "אפגניסטן", "code": "af" },
    { "country": "אלבניה", "code": "al" },
    { "country": "אלג'יריה", "code": "dz" },
    { "country": "אנדורה", "code": "ad" },
    { "country": "אנגולה", "code": "ao" },
    { "country": "ארגנטינה", "code": "ar" },
    { "country": "ארמניה", "code": "am" },
    { "country": "אוסטרליה", "code": "au" },
    { "country": "אוסטריה", "code": "at" },
    { "country": "אזרבייג'ן", "code": "az" },
    { "country": "בהאמה", "code": "bs" },
    { "country": "בחריין", "code": "bh" },
    { "country": "בנגלדש", "code": "bd" },
    { "country": "ברבדוס", "code": "bb" },
    { "country": "בלארוס", "code": "by" },
    { "country": "בלגיה", "code": "be" },
    { "country": "בליז", "code": "bz" },
    { "country": "בנין", "code": "bj" },
    { "country": "בהוטן", "code": "bt" },
    { "country": "בוליביה", "code": "bo" },
    { "country": "בוסניה והרצגובינה", "code": "ba" },
    { "country": "בוצואנה", "code": "bw" },
    { "country": "ברזיל", "code": "br" },
    { "country": "ברוניי", "code": "bn" },
    { "country": "בולגריה", "code": "bg" },
    { "country": "בורקינה פאסו", "code": "bf" },
    { "country": "בורונדי", "code": "bi" },
    { "country": "קייפ ורדה", "code": "cv" },
    { "country": "קמבודיה", "code": "kh" },
    { "country": "קמרון", "code": "cm" },
    { "country": "קנדה", "code": "ca" },
    { "country": "הרפובליקה המרכז-אפריקאית", "code": "cf" },
    { "country": "צ'אד", "code": "td" },
    { "country": "צ'ילה", "code": "cl" },
    { "country": "סין", "code": "cn" },
    { "country": "קולומביה", "code": "co" },
    { "country": "קומורו", "code": "km" },
    { "country": "קונגו (ברזוויל)", "code": "cg" },
    { "country": "קוסטה ריקה", "code": "cr" },
    { "country": "קרואטיה", "code": "hr" },
    { "country": "קובה", "code": "cu" },
    { "country": "קפריסין", "code": "cy" },
    { "country": "צ'כיה (הרפובליקה הצ'כית)", "code": "cz" },
    { "country": "דנמרק", "code": "dk" },
    { "country": "ג'יבוטי", "code": "dj" },
    { "country": "דומיניקה", "code": "dm" },
    { "country": "הרפובליקה הדומיניקנית", "code": "do" },
    { "country": "אקוודור", "code": "ec" },
    { "country": "מצרים", "code": "eg" },
    { "country": "אל סלבדור", "code": "sv" },
    { "country": "גינאה המשוונית", "code": "gq" },
    { "country": "אריתריאה", "code": "er" },
    { "country": "אסטוניה", "code": "ee" },
    { "country": "אסוואטיני (סווזילנד לשעבר)", "code": "sz" },
    { "country": "אתיופיה", "code": "et" },
    { "country": "פיג'י", "code": "fj" },
    { "country": "פינלנד", "code": "fi" },
    { "country": "צרפת", "code": "fr" },
    { "country": "גבון", "code": "ga" },
    { "country": "גמביה", "code": "gm" },
    { "country": "גאורגיה", "code": "ge" },
    { "country": "גרמניה", "code": "de" },
    { "country": "גאנה", "code": "gh" },
    { "country": "יוון", "code": "gr" },
    { "country": "גרנדה", "code": "gd" },
    { "country": "גואטמלה", "code": "gt" },
    { "country": "גינאה", "code": "gn" },
    { "country": "גינאה-ביסאו", "code": "gw" },
    { "country": "גיאנה", "code": "gy" },
    { "country": "האיטי", "code": "ht" },
    { "country": "הונדורס", "code": "hn" },
    { "country": "הונגריה", "code": "hu" },
    { "country": "איסלנד", "code": "is" },
    { "country": "הודו", "code": "in" },
    { "country": "אינדונזיה", "code": "id" },
    { "country": "איראן", "code": "ir" },
    { "country": "עיראק", "code": "iq" },
    { "country": "אירלנד", "code": "ie" },
    { "country": "ישראל", "code": "il" },
    { "country": "איטליה", "code": "it" },
    { "country": "ג'מייקה", "code": "jm" },
    { "country": "יפן", "code": "jp" },
    { "country": "ירדן", "code": "jo" },
    { "country": "קזחסטן", "code": "kz" },
    { "country": "קניה", "code": "ke" },
    { "country": "קיריבטי", "code": "ki" },
    { "country": "כווית", "code": "kw" },
    { "country": "קירגיזסטן", "code": "kg" },
    { "country": "לאוס", "code": "la" },
    { "country": "לטביה", "code": "lv" },
    { "country": "לבנון", "code": "lb" },
    { "country": "לסוטו", "code": "ls" },
    { "country": "ליבריה", "code": "lr" },
    { "country": "לוב", "code": "ly" },
    { "country": "ליכטנשטיין", "code": "li" },
    { "country": "ליטא", "code": "lt" },
    { "country": "לוקסמבורג", "code": "lu" },
    { "country": "מדגסקר", "code": "mg" },
    { "country": "מלאווי", "code": "mw" },
    { "country": "מלזיה", "code": "my" },
    { "country": "מלדיביים", "code": "mv" },
    { "country": "מאלי", "code": "ml" },
    { "country": "מלטה", "code": "mt" },
    { "country": "איי מרשל", "code": "mh" },
    { "country": "מאוריטניה", "code": "mr" },
    { "country": "מאוריציוס", "code": "mu" },
    { "country": "מקסיקו", "code": "mx" },
    { "country": "מיקרונזיה", "code": "fm" },
    { "country": "מולדובה", "code": "md" },
    { "country": "מונקו", "code": "mc" },
    { "country": "מונגוליה", "code": "mn" },
    { "country": "מונטנגרו", "code": "me" },
    { "country": "מרוקו", "code": "ma" },
    { "country": "מוזמביק", "code": "mz" },
    { "country": "מיאנמר (בורמה לשעבר)", "code": "mm" },
    { "country": "נמיביה", "code": "na" },
    { "country": "נאורו", "code": "nr" },
    { "country": "נפאל", "code": "np" },
    { "country": "הולנד", "code": "nl" },
    { "country": "ניו זילנד", "code": "nz" },
    { "country": "ניקרגואה", "code": "ni" },
    { "country": "ניז'ר", "code": "ne" },
    { "country": "ניגריה", "code": "ng" },
    { "country": "קוריאה הצפונית", "code": "kp" },
    { "country": "צפון מקדוניה", "code": "mk" },
    { "country": "נורווגיה", "code": "no" },
    { "country": "עומאן", "code": "om" },
    { "country": "פקיסטן", "code": "pk" },
    { "country": "פלאו", "code": "pw" },
    { "country": "מדינת פלסטין", "code": "ps" },
    { "country": "פנמה", "code": "pa" },
    { "country": "פפואה גינאה החדשה", "code": "pg" },
    { "country": "פרגוואי", "code": "py" },
    { "country": "פרו", "code": "pe" },
    { "country": "פיליפינים", "code": "ph" },
    { "country": "פולין", "code": "pl" },
    { "country": "פורטוגל", "code": "pt" },
    { "country": "קטאר", "code": "qa" },
    { "country": "רומניה", "code": "ro" },
    { "country": "רוסיה", "code": "ru" },
    { "country": "רואנדה", "code": "rw" },
    { "country": "סנט קיטס ונוויס", "code": "kn" },
    { "country": "סנט לוסיה", "code": "lc" },
    { "country": "סנט וינסנט והגרנדינים", "code": "vc" },
    { "country": "סמואה", "code": "ws" },
    { "country": "סן מרינו", "code": "sm" },
    { "country": "סאו טומה ופרינסיפה", "code": "st" },
    { "country": "ערב הסעודית", "code": "sa" },
    { "country": "סנגל", "code": "sn" },
    { "country": "סרביה", "code": "rs" },
    { "country": "סיישל", "code": "sc" },
    { "country": "סיירה לאון", "code": "sl" },
    { "country": "סינגפור", "code": "sg" },
    { "country": "סלובקיה", "code": "sk" },
    { "country": "סלובניה", "code": "si" },
    { "country": "איי שלמה", "code": "sb" },
    { "country": "סומליה", "code": "so" },
    { "country": "דרום אפריקה", "code": "za" },
    { "country": "דרום קוריאה", "code": "kr" },
    { "country": "דרום סודן", "code": "ss" },
    { "country": "ספרד", "code": "es" },
    { "country": "סרי לנקה", "code": "lk" },
    { "country": "סודן", "code": "sd" },
    { "country": "סורינאם", "code": "sr" },
    { "country": "שוודיה", "code": "se" },
    { "country": "שווייץ", "code": "ch" },
    { "country": "סוריה", "code": "sy" },
    { "country": "טייוואן", "code": "tw" },
    { "country": "טג'יקיסטן", "code": "tj" },
    { "country": "טנזניה", "code": "tz" },
    { "country": "תאילנד", "code": "th" },
    { "country": "טימור-לסטה", "code": "tl" },
    { "country": "טוגו", "code": "tg" },
    { "country": "טונגה", "code": "to" },
    { "country": "טרינידד וטובגו", "code": "tt" },
    { "country": "תוניסיה", "code": "tn" },
    { "country": "טורקיה", "code": "tr" },
    { "country": "טורקמניסטן", "code": "tm" },
    { "country": "טובלו", "code": "tv" },
    { "country": "אוגנדה", "code": "ug" },
    { "country": "אוקראינה", "code": "ua" },
    { "country": "איחוד האמירויות הערביות", "code": "ae" },
    { "country": "הממלכה המאוחדת", "code": "gb" },
    { "country": "ארצות הברית של אמריקה", "code": "us" },
    { "country": "אורוגוואי", "code": "uy" },
    { "country": "אוזבקיסטן", "code": "uz" },
    { "country": "ונואטו", "code": "vu" },
    { "country": "הוותיקן", "code": "va" },
    { "country": "ונצואלה", "code": "ve" },
    { "country": "וייטנאם", "code": "vn" },
    { "country": "תימן", "code": "ye" },
    { "country": "זמביה", "code": "zm" },
    { "country": "זימבבואה", "code": "zw" }
];


        let shuffledCountries = shuffleArray(countries);
        let currentCountryIndex = 0;
        let countdown;
        let isTimerMode = false;
        const flagElement = document.getElementById('flag');
        const countryNameElement = document.getElementById('countryName');
        const countryInfoElement = document.getElementById('countryInfo');
        const flagInfoElement = document.getElementById('flagInfo');
        const timerElement = document.getElementById('timer');
        const toggleButton = document.getElementById('toggleButton');

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function displayNextFlag() {
            clearInterval(countdown);
            countryInfoElement.style.display = 'none';
            countryInfoElement.textContent = '';
            flagInfoElement.style.display = 'none';
            flagInfoElement.textContent = '';

            if (currentCountryIndex >= shuffledCountries.length) {
                shuffledCountries = shuffleArray(countries);
                currentCountryIndex = 0;
            }

            const country = shuffledCountries[currentCountryIndex];
            flagElement.src = `https://flagcdn.com/${country.code}.svg`;
            flagElement.alt = country.country;
            countryNameElement.textContent = country.country;
            countryNameElement.style.display = 'none';
            currentCountryIndex++;

            if (isTimerMode) {
                startTimer();
            }
        }

        async function fetchCountryInfo(country) {
            const countryResponse = await fetch(`https://he.wikipedia.org/w/api.php?action=query&format=json&prop=extracts&exintro=&explaintext=&titles=${encodeURIComponent(country)}&origin=*`);
            const countryData = await countryResponse.json();
            const countryPages = countryData.query.pages;
            const countryPage = Object.values(countryPages)[0];
            if (countryPage.extract) {
                const countrySummary = countryPage.extract.split(/\s+/).slice(0, 150).join(' ');
                countryInfoElement.textContent = countrySummary;
                countryInfoElement.style.display = 'block';
            }

            const flagResponse = await fetch(`https://he.wikipedia.org/w/api.php?action=query&format=json&prop=extracts&exintro=&explaintext=&titles=דגל_${encodeURIComponent(country)}&origin=*`);
            const flagData = await flagResponse.json();
            const flagPages = flagData.query.pages;
            const flagPage = Object.values(flagPages)[0];
            if (flagPage.extract) {
                const flagSummary = flagPage.extract.split(/\s+/).slice(0, 150).join(' ');
                flagInfoElement.textContent = flagSummary;
                flagInfoElement.style.display = 'block';
            }
        }

        function startTimer() {
            let timeLeft = 6;
            timerElement.textContent = `זמן שנותר: ${timeLeft} שניות`;

            countdown = setInterval(() => {
                timeLeft -= 1;
                timerElement.textContent = `זמן שנותר: ${timeLeft} שניות`;

                if (timeLeft <= 0) {
                    clearInterval(countdown);
                    countryNameElement.style.display = 'block';
                    fetchCountryInfo(countryNameElement.textContent);
                    showPostNameTimer();
                }
            }, 1000);
        }

        function showPostNameTimer() {
            let postNameTimeLeft = 2;
            timerElement.textContent = `הדגל הבא בעוד: ${postNameTimeLeft} שניות`;

            countdown = setInterval(() => {
                postNameTimeLeft -= 1;
                timerElement.textContent = `הדגל הבא בעוד: ${postNameTimeLeft} שניות`;

                if (postNameTimeLeft <= 0) {
                    clearInterval(countdown);
                    displayNextFlag();
                }
            }, 1000);
        }

        flagElement.addEventListener('click', () => {
            countryNameElement.style.display = 'block';
            fetchCountryInfo(countryNameElement.textContent);
            if (isTimerMode) {
                showPostNameTimer();
            }
        });

        countryNameElement.addEventListener('click', displayNextFlag);

        toggleButton.addEventListener('click', () => {
            isTimerMode = !isTimerMode;
            toggleButton.textContent = isTimerMode ? 'החלף למצב ללא טיימר' : 'החלף למצב עם טיימר';
            clearInterval(countdown);
            timerElement.textContent = '';
        });

        // הצגה ראשונית
        displayNextFlag();
    </script>
</body>
</html>
